# 인터럽트(interrupt)

---

프로세스 실행 도중에 예기치 않은 상황이 발생할 때 발생한 상황을 처리한 후 실행 중인 작업으로 복귀하는 것
- 하드웨어 장치가 CPU에게 어떤 사실을 알려주거나 CPU의 서비스를 요청해야 할 경우, CPU 내에 있는 인터럽트 라인을 세팅하여 인터럽트를 발생시킨다.
  - 프로그램이 명령을 수행하기 위해서는 CPU를 할당받아야 함.
- CPU는 매번 프로그램 카운터가 가리고 있는 곳의 명령을 수행한 뒤, 다음 명령을 수행하기 직전에 인터럽트 라인 세팅되었는지를 체크한다.
- 이를 통해 인터럽트가 발생했으면 CPU는 현재 수행 중이던 프로세스를 멈추고 운영 체제의 인터럽트 처리 루틴으로 이동하여 인터럽트 처리를 수행한다.

## 인터럽트의 종류

### 1.하드웨어 인터럽트
- 일반적인 하드웨어 인터럽트 
  - 하드웨어 컨트롤러가 CPU의 서비스를 요청하기 위해 발생시키는 인터럽트
- 운영체제의 타이머 인터럽트
  - 운영체제에서는 각 프로그램들이 공평한 시간 동안 CPU를 할당 받을 수 있도록 세팅된 시간 동안 CPU를 사용하고, 사용시간이 종료되면 인터럽트를 발생시킨다.

### 2.소프트웨어 인터럽트(Trap)
소프트웨어(사용자 프로그램)가 스스로 인터럽트 라인을 세팅한다.
- 예외 상황(Exception)
  - 프로그램이 허용되지 않은 연산을 수행하려고 할 때 자동적으로 발생하는 인터럽트
  - ex) 0으로 나누기, 권한 없는 메모리 참조 등..
- 시스템 콜(System Call)
  - 프로세스가 운영 체제의 서비스를 요청하기 위해 커널의 함수를 호출하는 경우 발생하는 인터럽트

<blockquote>
<b>시스템 콜</b>이나 <b>예외 상황</b>은 모두 사용자 프로세스로부터 CPU의 제어권이 운영 체제에게 이양되어 처리되는데
이 과정에 인터럽트 라인을 세팅하여 인터럽트를 발생시킨 후 제어권이 넘어가게 되므로 이들도 넓은 의미에서는 인터럽트의 범주에 포함시킨다.<br>
<b>단지 인터럽트를 발생시키는 주체가 하드웨어 장치가 아닌 소프트웨어이므로 이들을 소프트웨어 인터럽트라 부른다.</b>
</blockquote>

## 인터럽트 발생 처리 과정
A 프로그램이 CPU를 할당받고 명령을 수행하고 있는데 인터럽트가 발생하면 A는 현재 수행중인 명령의 위치를 저장. <br>
그 후, 운영체제 내부 코드인 인터럽트 처리 루틴으로 넘어가서 인터럽트를 처리하고 다시 돌아와 A의 이전 작업 지점부터 수행을 계속 이어나가게 된다.
<blockquote>
진행 중이던 A 프로세스의 정보는 프로세스 제어 블록(PCB:Process Control Block)에 저장한다. <br>
그리고 인터럽트 처리를 모두 마치면 프로그램 A의 PCB에 저장된 주소를 복원시켜 원래 수행하던 일을 재개하면 된다.
</blockquote>